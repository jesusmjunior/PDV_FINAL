<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORION PDV - Configurações</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Roboto+Mono&display=swap">
    <link rel="stylesheet" href="assets/css/orion-theme.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="assets/img/favicon.ico" type="image/x-icon">
</head>
<body>
    <!-- Container Principal -->
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="assets/img/logo-small.png" alt="ORION PDV">
                    <span>ORION PDV</span>
                </div>
                <button id="sidebar-collapse" class="sidebar-toggle d-none d-md-block">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
            
            <div class="sidebar-menu">
                <a href="dashboard.html" class="menu-item">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="venda.html" class="menu-item">
                    <i class="fas fa-shopping-cart"></i>
                    <span>Vendas PDV</span>
                </a>
                <a href="produto.html" class="menu-item">
                    <i class="fas fa-box"></i>
                    <span>Produtos</span>
                </a>
                <a href="estoque.html" class="menu-item">
                    <i class="fas fa-warehouse"></i>
                    <span>Estoque</span>
                </a>
                <a href="cliente.html" class="menu-item">
                    <i class="fas fa-users"></i>
                    <span>Clientes</span>
                </a>
                <a href="relatorio.html" class="menu-item">
                    <i class="fas fa-chart-bar"></i>
                    <span>Relatórios</span>
                </a>
                <a href="config.html" class="menu-item active">
                    <i class="fas fa-cog"></i>
                    <span>Configurações</span>
                </a>
            </div>
            
            <div class="sidebar-footer">
                <div class="user-menu" id="user-menu">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-info">
                        <div class="user-name" id="user-name">Carregando...</div>
                        <div class="user-role" id="user-role">Carregando...</div>
                    </div>
                </div>
                <button id="btn-logout" class="sidebar-toggle">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
        
        <!-- Conteúdo Principal -->
        <div class="main-content">
            <div class="topbar">
                <div class="topbar-title">
                    <h1>Configurações do Sistema</h1>
                </div>
                <div class="topbar-actions">
                    <div id="current-date" class="d-none d-md-block">Carregando data...</div>
                </div>
            </div>
            
            <div class="page-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <i class="fas fa-cogs"></i> Configurações do ORION PDV
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Abas de Configuração -->
                        <div class="config-tabs">
                            <div id="tab-geral" class="config-tab active">Geral</div>
                            <div id="tab-aparencia" class="config-tab">Aparência</div>
                            <div id="tab-backup" class="config-tab">Backup</div>
                            <div id="tab-sobre" class="config-tab">Sobre</div>
                        </div>
                        
                        <form id="form-config">
                            <!-- Conteúdo da aba Geral -->
                            <div id="content-geral" class="config-content active">
                                <div class="row" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                                    <div>
                                        <div class="form-group">
                                            <label for="nome-empresa" class="form-label">Nome da Empresa</label>
                                            <input type="text" id="nome-empresa" class="form-control" placeholder="Nome da sua empresa">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="slogan" class="form-label">Slogan</label>
                                            <input type="text" id="slogan" class="form-control" placeholder="Slogan ou descrição">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="cnpj" class="form-label">CNPJ</label>
                                            <input type="text" id="cnpj" class="form-control" placeholder="CNPJ">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="telefone" class="form-label">Telefone</label>
                                            <input type="text" id="telefone" class="form-control" placeholder="Telefone">
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="form-group">
                                            <label for="email" class="form-label">E-mail</label>
                                            <input type="email" id="email" class="form-control" placeholder="E-mail de contato">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="endereco" class="form-label">Endereço</label>
                                            <input type="text" id="endereco" class="form-control" placeholder="Endereço completo">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="cidade" class="form-label">Cidade/UF</label>
                                            <input type="text" id="cidade" class="form-control" placeholder="Cidade/UF">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="logo-url" class="form-label">URL da Logo</label>
                                            <input type="text" id="logo-url" class="form-control" placeholder="URL da imagem da logo">
                                            <div class="mt-2">
                                                <img id="preview-logo" src="assets/img/logo.png" alt="Logo Preview" class="logo-preview">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="chave-pix" class="form-label">Chave PIX</label>
                                    <input type="text" id="chave-pix" class="form-control" placeholder="Chave PIX para recebimentos">
                                </div>
                            </div>
                            
                            <!-- Conteúdo da aba Aparência -->
                            <div id="content-aparencia" class="config-content">
                                <div class="form-group">
                                    <label for="tema" class="form-label">Tema</label>
                                    <select id="tema" class="form-control">
                                        <option value="dark">Escuro (Padrão)</option>
                                        <option value="light">Claro</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="cor-primaria" class="form-label">Cor Primária</label>
                                    <div class="d-flex align-items-center gap-2">
                                        <input type="color" id="cor-primaria" value="#0B3D91">
                                        <span id="preview-cor-primaria" class="color-preview" style="background-color: #0B3D91;"></span>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="cor-secundaria" class="form-label">Cor Secundária</label>
                                    <div class="d-flex align-items-center gap-2">
                                        <input type="color" id="cor-secundaria" value="#1E88E5">
                                        <span id="preview-cor-secundaria" class="color-preview" style="background-color: #1E88E5;"></span>
                                    </div>
                                </div>
                                
                                <div class="alert alert-info mt-3">
                                    <i class="fas fa-info-circle"></i> As alterações de tema e cores serão aplicadas após recarregar a página.
                                </div>
                            </div>
                            
                            <!-- Conteúdo da aba Backup -->
                            <div id="content-backup" class="config-content">
                                <div class="mb-4">
                                    <h4 class="mb-2">Exportar Dados</h4>
                                    <p class="text-muted mb-3">Faça backup de todos os seus dados para importar posteriormente ou manter como cópia de segurança.</p>
                                    
                                    <button type="button" id="btn-exportar-dados" class="btn btn-primary">
                                        <i class="fas fa-download"></i> Exportar Todos os Dados
                                    </button>
                                </div>
                                
                                <div class="mb-4">
                                    <h4 class="mb-2">Importar Dados</h4>
                                    <p class="text-muted mb-3">Restaure seus dados a partir de um arquivo de backup previamente exportado.</p>
                                    
                                    <div class="d-flex align-items-center gap-2">
                                        <button type="button" id="btn-importar-dados" class="btn btn-primary">
                                            <i class="fas fa-upload"></i> Importar Dados
                                        </button>
                                        <input type="file" id="input-importar-dados" accept=".json" style="display: none;">
                                        <span id="arquivo-selecionado" class="text-muted"></span>
                                    </div>
                                    
                                    <div class="alert alert-warning mt-3">
                                        <i class="fas fa-exclamation-triangle"></i> Atenção: Importar dados substituirá todos os dados atuais do sistema. Certifique-se de fazer um backup antes de importar.
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 class="mb-2">Resetar Configurações</h4>
                                    <p class="text-muted mb-3">Restaura todas as configurações para os valores padrão. Esta ação não afeta produtos, clientes ou vendas.</p>
                                    
                                    <button type="button" id="btn-resetar-config" class="btn btn-danger">
                                        <i class="fas fa-undo"></i> Resetar Configurações
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Conteúdo da aba Sobre -->
                            <div id="content-sobre" class="config-content">
                                <div class="text-center mb-4">
                                    <img src="assets/img/logo.png" alt="ORION PDV" style="max-width: 200px; margin-bottom: 1rem;">
                                    <h3>ORION PDV</h3>
                                    <p>Sistema de Gestão de Vendas</p>
                                    <p>Versão <span id="versao-sistema">1.0.0</span></p>
                                </div>
                                
                                <div class="alert alert-info mb-4">
                                    <h5><i class="fas fa-info-circle"></i> Sobre o ORION PDV</h5>
                                    <p>O ORION PDV é um sistema completo para gestão de vendas, estoque e clientes, desenvolvido para facilitar o dia a dia do seu negócio com uma interface moderna e intuitiva.</p>
                                </div>
                                
                                <div class="mb-4">
                                    <h5>Recursos</h5>
                                    <ul style="list-style-type: none; padding-left: 0.5rem;">
                                        <li><i class="fas fa-check text-success"></i> Controle de vendas e estoque</li>
                                        <li><i class="fas fa-check text-success"></i> Cadastro de produtos com código de barras</li>
                                        <li><i class="fas fa-check text-success"></i> Gerenciamento de clientes</li>
                                        <li><i class="fas fa-check text-success"></i> Relatórios e estatísticas</li>
                                        <li><i class="fas fa-check text-success"></i> Sistema responsivo (desktop e mobile)</li>
                                        <li><i class="fas fa-check text-success"></i> Backup e restauração de dados</li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <h5>Desenvolvido por</h5>
                                    <p>Equipe ORION &copy; 2025</p>
                                </div>
                            </div>
                            
                            <!-- Botões de Ação (exceto para aba Sobre) -->
                            <div id="config-actions" class="d-flex justify-between mt-4">
                                <button type="button" class="btn btn-outline-primary" id="btn-cancelar-config">
                                    <i class="fas fa-times"></i> Cancelar
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Salvar Configurações
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Notificações -->
    <div class="toast-container" id="toast-container"></div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="assets/js/database.js"></script>
    <script src="assets/js/db-fix.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/core.js"></script>
    <script src="assets/js/config.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Verificar autenticação
            if (!auth.verificarAutenticacao()) {
                window.location.href = 'index.html';
                return;
            }
            
            // Dados do usuário
            const user = auth.getUsuarioAtual();
            document.getElementById('user-name').textContent = user.nome;
            document.getElementById('user-role').textContent = user.perfil === 'admin' ? 'Administrador' : user.perfil === 'supervisor' ? 'Supervisor' : 'Vendedor';
            
            // Data atual
            const dataAtual = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = dataAtual.toLocaleDateString('pt-BR', options);
            
            // Elementos DOM
            const formConfig = document.getElementById('form-config');
            const nomeEmpresaInput = document.getElementById('nome-empresa');
            const sloganInput = document.getElementById('slogan');
            const cnpjInput = document.getElementById('cnpj');
            const telefoneInput = document.getElementById('telefone');
            const emailInput = document.getElementById('email');
            const enderecoInput = document.getElementById('endereco');
            const cidadeInput = document.getElementById('cidade');
            const logoUrlInput = document.getElementById('logo-url');
            const chavePixInput = document.getElementById('chave-pix');
            const temaSelect = document.getElementById('tema');
            const corPrimariaInput = document.getElementById('cor-primaria');
            const corSecundariaInput = document.getElementById('cor-secundaria');
            const previewCorPrimaria = document.getElementById('preview-cor-primaria');
            const previewCorSecundaria = document.getElementById('preview-cor-secundaria');
            const previewLogo = document.getElementById('preview-logo');
            
            // Tabs de configuração
            const tabGeral = document.getElementById('tab-geral');
            const tabAparencia = document.getElementById('tab-aparencia');
            const tabBackup = document.getElementById('tab-backup');
            const tabSobre = document.getElementById('tab-sobre');
            
            const contentGeral = document.getElementById('content-geral');
            const contentAparencia = document.getElementById('content-aparencia');
            const contentBackup = document.getElementById('content-backup');
            const contentSobre = document.getElementById('content-sobre');
            const configActions = document.getElementById('config-actions');
            
            // Elementos de backup
            const btnExportarDados = document.getElementById('btn-exportar-dados');
            const btnImportarDados = document.getElementById('btn-importar-dados');
            const inputImportarDados = document.getElementById('input-importar-dados');
            const arquivoSelecionado = document.getElementById('arquivo-selecionado');
            const btnResetarConfig = document.getElementById('btn-resetar-config');
            const btnCancelarConfig = document.getElementById('btn-cancelar-config');
            
            // Verificar versão do sistema
            const versaoElement = document.getElementById('versao-sistema');
            versaoElement.textContent = db.VERSION || '1.0.0';
            
            // Carregar configurações
            carregarConfiguracoes();
            
            // Event Listeners
            
            // Tabs
            tabGeral.addEventListener('click', function() {
                ativarAba('geral');
            });
            
            tabAparencia.addEventListener('click', function() {
                ativarAba('aparencia');
            });
            
            tabBackup.addEventListener('click', function() {
                ativarAba('backup');
            });
            
            tabSobre.addEventListener('click', function() {
                ativarAba('sobre');
            });
            
            // Formulário de configurações
            formConfig.addEventListener('submit', function(e) {
                e.preventDefault();
                salvarConfiguracoes();
            });
            
            // Preview de cores
            corPrimariaInput.addEventListener('input', function() {
                previewCorPrimaria.style.backgroundColor = this.value;
            });
            
            corSecundariaInput.addEventListener('input', function() {
                previewCorSecundaria.style.backgroundColor = this.value;
            });
            
            // Preview de logo
            logoUrlInput.addEventListener('input', function() {
                previewLogo.src = this.value || 'assets/img/logo.png';
            });
            
            // Erro de carregamento da imagem
            previewLogo.addEventListener('error', function() {
                this.src = 'assets/img/logo.png';
            });
            
            // Formatação de CNPJ
            cnpjInput.addEventListener('input', function() {
                formatarCNPJ(this);
            });
            
            // Formatação de telefone
            telefoneInput.addEventListener('input', function() {
                formatarTelefone(this);
            });
            
            // Backup e restauração
            btnExportarDados.addEventListener('click', exportarDados);
            
            btnImportarDados.addEventListener('click', function() {
                inputImportarDados.click();
            });
            
            inputImportarDados.addEventListener('change', function() {
                if (this.files.length > 0) {
                    arquivoSelecionado.textContent = this.files[0].name;
                } else {
                    arquivoSelecionado.textContent = '';
                }
            });
            
            inputImportarDados.addEventListener('change', importarDados);
            
            // Resetar configurações
            btnResetarConfig.addEventListener('click', function() {
                if (confirm('Tem certeza que deseja resetar todas as configurações? Esta ação não pode ser desfeita.')) {
                    resetarConfiguracoes();
                }
            });
            
            // Cancelar alterações
            btnCancelarConfig.addEventListener('click', function() {
                carregarConfiguracoes();
                exibirMensagem('Alterações canceladas', 'info');
            });
            
            // Logout
            document.getElementById('btn-logout').addEventListener('click', function() {
                auth.fazerLogout();
                window.location.href = 'index.html';
            });
            
            // ========== FUNÇÕES ==========
            
            function ativarAba(aba) {
                // Desativar todas as abas
                tabGeral.classList.remove('active');
                tabAparencia.classList.remove('active');
                tabBackup.classList.remove('active');
                tabSobre.classList.remove('active');
                
                // Ocultar todos os conteúdos
                contentGeral.classList.remove('active');
                contentAparencia.classList.remove('active');
                contentBackup.classList.remove('active');
                contentSobre.classList.remove('active');
                
                // Ativar aba selecionada
                if (aba === 'geral') {
                    tabGeral.classList.add('active');
                    contentGeral.classList.add('active');
                    configActions.style.display = 'flex';
                } else if (aba === 'aparencia') {
                    tabAparencia.classList.add('active');
                    contentAparencia.classList.add('active');
                    configActions.style.display = 'flex';
                } else if (aba === 'backup') {
                    tabBackup.classList.add('active');
                    contentBackup.classList.add('active');
                    configActions.style.display = 'none';
                } else if (aba === 'sobre') {
                    tabSobre.classList.add('active');
                    contentSobre.classList.add('active');
                    configActions.style.display = 'none';
                }
            }
            
            function carregarConfiguracoes() {
                // Obter configurações
                const config = db.getConfig ? db.getConfig() : {};
                
                // Preencher formulário
                nomeEmpresaInput.value = config.nome_empresa || 'ORION PDV';
                sloganInput.value = config.slogan || 'Sistema de Gestão de Vendas';
                cnpjInput.value = config.cnpj || '';
                telefoneInput.value = config.telefone || '';
                emailInput.value = config.email || '';
                enderecoInput.value = config.endereco || '';
                cidadeInput.value = config.cidade || '';
                logoUrlInput.value = config.logo_url || 'assets/img/logo.png';
                chavePixInput.value = config.chave_pix || '';
                temaSelect.value = config.tema || 'dark';
                corPrimariaInput.value = config.cor_primaria || '#0B3D91';
                corSecundariaInput.value = config.cor_secundaria || '#1E88E5';
                
                // Atualizar previews
                previewCorPrimaria.style.backgroundColor = config.cor_primaria || '#0B3D91';
                previewCorSecundaria.style.backgroundColor = config.cor_secundaria || '#1E88E5';
                previewLogo.src = config.logo_url || 'assets/img/logo.png';
            }
            
            function salvarConfiguracoes() {
                // Criar objeto de configuração
                const config = {
                    nome_empresa: nomeEmpresaInput.value || 'ORION PDV',
                    slogan: sloganInput.value || 'Sistema de Gestão de Vendas',
                    cnpj: cnpjInput.value || '',
                    telefone: telefoneInput.value || '',
                    email: emailInput.value || '',
                    endereco: enderecoInput.value || '',
                    cidade: cidadeInput.value || '',
                    logo_url: logoUrlInput.value || 'assets/img/logo.png',
                    chave_pix: chavePixInput.value || '',
                    tema: temaSelect.value || 'dark',
                    cor_primaria: corPrimariaInput.value || '#0B3D91',
                    cor_secundaria: corSecundariaInput.value || '#1E88E5'
                };
                
                // Salvar no banco de dados
                try {
                    db.salvarConfig(config);
                    
                    // Aplicar tema
                    document.body.className = '';
                    document.body.classList.add('theme-' + config.tema);
                    
                    // Exibir mensagem de sucesso
                    exibirMensagem('Configurações salvas com sucesso!', 'success');
                } catch (erro) {
                    console.error('Erro ao salvar configurações:', erro);
                    exibirMensagem('Erro ao salvar configurações: ' + erro, 'error');
                }
            }
            
            function resetarConfiguracoes() {
                try {
                    // Configurações padrão
                    const configPadrao = {
                        nome_empresa: 'ORION PDV',
                        slogan: 'Sistema de Gestão de Vendas',
                        cnpj: '',
                        telefone: '',
                        email: '',
                        endereco: '',
                        cidade: '',
                        logo_url: 'assets/img/logo.png',
                        chave_pix: '',
                        tema: 'dark',
                        cor_primaria: '#0B3D91',
                        cor_secundaria: '#1E88E5'
                    };
                    
                    // Salvar no banco de dados
                    db.salvarConfig(configPadrao);
                    
                    // Recarregar formulário
                    carregarConfiguracoes();
                    
                    // Aplicar tema
                    document.body.className = '';
                    document.body.classList.add('theme-' + configPadrao.tema);
                    
                    // Exibir mensagem de sucesso
                    exibirMensagem('Configurações resetadas com sucesso!', 'success');
                } catch (erro) {
                    console.error('Erro ao resetar configurações:', erro);
                    exibirMensagem('Erro ao resetar configurações: ' + erro, 'error');
                }
            }
            
            function exportarDados() {
                try {
                    // Exportar dados
                    const dados = db.exportarDados();
                    
                    if (!dados) {
                        throw new Error('Falha ao exportar dados');
                    }
                    
                    // Criar blob
                    const blob = new Blob([dados], { type: 'application/json' });
                    
                    // Criar URL
                    const url = URL.createObjectURL(blob);
                    
                    // Criar link de download
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `backup_orion_pdv_${new Date().toISOString().split('T')[0]}.json`;
                    a.style.display = 'none';
                    
                    // Adicionar ao DOM
                    document.body.appendChild(a);
                    
                    // Simular clique
                    a.click();
                    
                    // Limpar
                    setTimeout(() => {
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    }, 100);
                    
                    // Exibir mensagem de sucesso
                    exibirMensagem('Backup exportado com sucesso!', 'success');
                } catch (erro) {
                    console.error('Erro ao exportar dados:', erro);
                    exibirMensagem('Erro ao exportar dados: ' + erro, 'error');
                }
            }
            
            function importarDados(e) {
                const file = e.target.files[0];
                
                if (!file) {
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    try {
                        const dados = event.target.result;
                        
                        // Confirmar importação
                        if (confirm('Tem certeza que deseja importar estes dados? Todos os dados atuais serão substituídos.')) {
                            // Importar dados
                            const resultado = db.importarDados(dados);
                            
                            if (resultado) {
                                // Exibir mensagem de sucesso
                                exibirMensagem('Dados importados com sucesso! O sistema será reiniciado.', 'success');
                                
                                // Recarregar página após 2 segundos
                                setTimeout(() => {
                                    window.location.reload();
                                }, 2000);
                            } else {
                                exibirMensagem('Erro ao importar dados: formato inválido', 'error');
                            }
                        }
                    } catch (erro) {
                        console.error('Erro ao importar dados:', erro);
                        exibirMensagem('Erro ao importar dados: ' + erro.message, 'error');
                    }
                };
                
                reader.onerror = function() {
                    exibirMensagem('Erro ao ler o arquivo.', 'error');
                };
                
                reader.readAsText(file);
                
                // Limpar input para permitir selecionar o mesmo arquivo novamente
                e.target.value = '';
            }
            
            function formatarCNPJ(input) {
                let cnpj = input.value.replace(/\D/g, '');
                
                if (cnpj.length > 14) {
                    cnpj = cnpj.substring(0, 14);
                }
                
                // Aplicar formatação
                if (cnpj.length > 12) {
                    cnpj = cnpj.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
                } else if (cnpj.length > 8) {
                    cnpj = cnpj.replace(/(\d{2})(\d{3})(\d{3})(\d{0,4})/, '$1.$2.$3/$4');
                } else if (cnpj.length > 5) {
                    cnpj = cnpj.replace(/(\d{2})(\d{3})(\d{0,3})/, '$1.$2.$3');
                } else if (cnpj.length > 2) {
                    cnpj = cnpj.replace(/(\d{2})(\d{0,3})/, '$1.$2');
                }
                
                input.value = cnpj;
            }
            
            function formatarTelefone(input) {
                let telefone = input.value.replace(/\D/g, '');
                
                if (telefone.length > 11) {
                    telefone = telefone.substring(0, 11);
                }
                
                // Aplicar formatação
                if (telefone.length > 10) {
                    // Celular com 9 dígitos (XX) XXXXX-XXXX
                    telefone = telefone.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                } else if (telefone.length > 6) {
                    // Telefone fixo (XX) XXXX-XXXX
                    telefone = telefone.replace(/(\d{2})(\d{4,5})(\d{0,4})/, '($1) $2-$3');
                } else if (telefone.length > 2) {
                    // DDD
                    telefone = telefone.replace(/(\d{2})(\d{0,5})/, '($1) $2');
                }
                
                input.value = telefone;
            }
            
            // Função para exibir mensagens de notificação
            function exibirMensagem(mensagem, tipo) {
                const toastContainer = document.getElementById('toast-container');
                
                const toast = document.createElement('div');
                toast.className = `toast-notification toast-${tipo}`;
                
                toast.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-${tipo === 'success' ? 'check-circle' : tipo === 'warning' ? 'exclamation-circle' : tipo === 'info' ? 'info-circle' : 'times-circle'}"></i>
                        <span>${mensagem}</span>
                    </div>
                `;
                
                toastContainer.appendChild(toast);
                
                // Exibir com animação
                setTimeout(() => {
                    toast.classList.add('show');
                }, 10);
                
                // Remover após 3 segundos
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => {
                        toastContainer.removeChild(toast);
                    }, 300);
                }, 3000);
            }
        });
    </script>
</body>
</html>
